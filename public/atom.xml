<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>不羁</title>
  
  <subtitle>别来无恙</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://leeyj.coding.me/"/>
  <updated>2019-05-11T14:26:50.232Z</updated>
  <id>https://leeyj.coding.me/</id>
  
  <author>
    <name>Leeyj</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linuxTools(小工具集合)</title>
    <link href="https://leeyj.coding.me/2019/04/30/linuxTools-%E5%B0%8F%E5%B7%A5%E5%85%B7%E9%9B%86%E5%90%88/"/>
    <id>https://leeyj.coding.me/2019/04/30/linuxTools-小工具集合/</id>
    <published>2019-04-30T08:18:37.000Z</published>
    <updated>2019-05-11T14:26:50.232Z</updated>
    
    <content type="html"><![CDATA[<h6 id="Linux下常用的小工具集合（grep-cut-soft-uniq-tee-paste-tr-diff-wc-du-df"><a href="#Linux下常用的小工具集合（grep-cut-soft-uniq-tee-paste-tr-diff-wc-du-df" class="headerlink" title="Linux下常用的小工具集合（grep cut soft uniq tee paste tr diff wc du df)"></a>Linux下常用的小工具集合（grep cut soft uniq tee paste tr diff wc du df)</h6><p>这是一个测试</p><p>macshangmiances </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h6 id=&quot;Linux下常用的小工具集合（grep-cut-soft-uniq-tee-paste-tr-diff-wc-du-df&quot;&gt;&lt;a href=&quot;#Linux下常用的小工具集合（grep-cut-soft-uniq-tee-paste-tr-diff-wc-du-df
      
    
    </summary>
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/categories/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/tags/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>linux下解压windows上压缩rar包</title>
    <link href="https://leeyj.coding.me/2019/04/30/linux%E4%B8%8B%E8%A7%A3%E5%8E%8Bwindows%E4%B8%8A%E5%8E%8B%E7%BC%A9rar%E5%8C%85/"/>
    <id>https://leeyj.coding.me/2019/04/30/linux下解压windows上压缩rar包/</id>
    <published>2019-04-30T05:48:55.000Z</published>
    <updated>2019-04-30T06:15:10.476Z</updated>
    
    <content type="html"><![CDATA[<h5 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h5><p><code># wget  http://www.rarlab.com/rar/rarlinux-3.8.0.tar.gz</code></p><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># tar xvzf rarlinux-3.8.0.tar.gz</span><br><span class="line"># cd rar</span><br><span class="line"># make </span><br><span class="line"># make install</span><br></pre></td></tr></table></figure><h5 id="rar命令语法"><a href="#rar命令语法" class="headerlink" title="rar命令语法"></a>rar命令语法</h5><p>将 /etc 目录压缩为 etc.rar 命令为：\<br><code># rar a etc.rar /etc</code>\<br>将 etc.rar 解压 命令为：\<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rar x etc.rar</span><br><span class="line">unrar -e etc.rar</span><br></pre></td></tr></table></figure></p><h5 id="rar帮助手册"><a href="#rar帮助手册" class="headerlink" title="rar帮助手册"></a>rar帮助手册</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># rar</span></span><br><span class="line"></span><br><span class="line">RAR 3.80   Copyright (c) 1993-2008 Alexander Roshal   16 Sep 2008</span><br><span class="line">Shareware version         Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Usage:     rar <span class="xml"><span class="tag">&lt;<span class="name">command</span>&gt;</span></span> -<span class="xml"><span class="tag">&lt;<span class="name">switch</span> <span class="attr">1</span>&gt;</span></span> -<span class="xml"><span class="tag">&lt;<span class="name">switch</span> <span class="attr">N</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;<span class="name">archive</span>&gt;</span></span> <span class="xml"><span class="tag">&lt;<span class="name">files...</span>&gt;</span></span></span><br><span class="line"><span class="code">               &lt;@listfiles...&gt; &lt;path_to_extract\&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Commands</span>&gt;</span></span></span><br><span class="line">  a             Add files to archive</span><br><span class="line">  c             Add archive comment</span><br><span class="line">  cf            Add files comment</span><br><span class="line">  ch            Change archive parameters</span><br><span class="line">  cw            Write archive comment to file</span><br><span class="line">  d             Delete files from archive</span><br><span class="line">  e             Extract files to current directory</span><br><span class="line">  f             Freshen files in archive</span><br><span class="line">  i[par]=<span class="xml"><span class="tag">&lt;<span class="name">str</span>&gt;</span></span>  Find string in archives</span><br><span class="line">  k             Lock archive</span><br><span class="line">  l[t,b]        List archive [technical, bare]</span><br><span class="line">  m[f]          Move to archive [files only]</span><br><span class="line">  p             Print file to stdout</span><br><span class="line">  r             Repair archive</span><br><span class="line">  rc            Reconstruct missing volumes</span><br><span class="line">  rn            Rename archived files</span><br><span class="line">  rr[N]         Add data recovery record</span><br><span class="line">  rv[N]         Create recovery volumes</span><br><span class="line">  s[name|-]     Convert archive to or from SFX</span><br><span class="line">  t             Test archive files</span><br><span class="line">  u             Update files in archive</span><br><span class="line">  v[t,b]        Verbosely list archive [technical,bare]</span><br><span class="line">  x             Extract files with full path</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">Switches</span>&gt;</span></span></span><br><span class="line">  -             Stop switches scanning</span><br><span class="line">  ad            Append archive name to destination path</span><br><span class="line">  ag[format]    Generate archive name using the current date</span><br><span class="line">  ap<span class="xml"><span class="tag">&lt;<span class="name">path</span>&gt;</span></span>      Set path inside archive</span><br><span class="line">  as            Synchronize archive contents</span><br><span class="line">  av            Put authenticity verification (registered versions only)</span><br><span class="line">  av-           Disable authenticity verification check</span><br><span class="line">  c-            Disable comments show</span><br><span class="line">  cfg-          Disable read configuration</span><br><span class="line">  cl            Convert names to lower case</span><br><span class="line">  cu            Convert names to upper case</span><br><span class="line">  df            Delete files after archiving</span><br><span class="line">  dh            Open shared files</span><br><span class="line">  ds            Disable name sort for solid archive</span><br><span class="line">  dw            Wipe files after archiving</span><br><span class="line">  e[+]<span class="xml"><span class="tag">&lt;<span class="name">attr</span>&gt;</span></span>    Set file exclude and include attributes</span><br><span class="line">  ed            Do not add empty directories</span><br><span class="line">  en            Do not put 'end of archive' block</span><br><span class="line">  ep            Exclude paths from names</span><br><span class="line">  ep1           Exclude base directory from names</span><br><span class="line">  ep3           Expand paths to full including the drive letter</span><br><span class="line">  f             Freshen files</span><br><span class="line">  hp[password]  Encrypt both file data and headers</span><br><span class="line">  id[c,d,p,q]   Disable messages</span><br><span class="line">  ierr          Send all messages to stderr</span><br><span class="line">  ilog[name]    Log errors to file (registered versions only)</span><br><span class="line">  inul          Disable all messages</span><br><span class="line">  isnd          Enable sound</span><br><span class="line">  k             Lock archive</span><br><span class="line">  kb            Keep broken extracted files</span><br><span class="line">  m<span class="xml"><span class="tag">&lt;<span class="name">0..5</span>&gt;</span></span>       Set compression level (0-store...3-default...5-maximal)</span><br><span class="line">  mc<span class="xml"><span class="tag">&lt;<span class="name">par</span>&gt;</span></span>       Set advanced compression parameters</span><br><span class="line">  md<span class="xml"><span class="tag">&lt;<span class="name">size</span>&gt;</span></span>      Dictionary size in KB (64,128,256,512,1024,2048,4096 or A-G)</span><br><span class="line">  ms[ext;ext]   Specify file types to store</span><br><span class="line">  n<span class="xml"><span class="tag">&lt;<span class="name">file</span>&gt;</span></span>       Include only specified file</span><br><span class="line">  n@            Read file names to include from stdin</span><br><span class="line">  n@<span class="xml"><span class="tag">&lt;<span class="name">list</span>&gt;</span></span>      Include files in specified list file</span><br><span class="line">  o[+|-]        Set the overwrite mode</span><br><span class="line">  ol            Save symbolic links as the link instead of the file</span><br><span class="line">  or            Rename files automatically</span><br><span class="line">  ow            Save or restore file owner and group</span><br><span class="line">  p[password]   Set password</span><br><span class="line">  p-            Do not query password</span><br><span class="line">  r             Recurse subdirectories</span><br><span class="line">  r0            Recurse subdirectories for wildcard names only</span><br><span class="line">  rr[N]         Add data recovery record</span><br><span class="line">  rv[N]         Create recovery volumes</span><br><span class="line">  s[<span class="xml"><span class="tag">&lt;<span class="name">N</span>&gt;</span></span>,v[-],e] Create solid archive</span><br><span class="line">  s-            Disable solid archiving</span><br><span class="line">  sc<span class="xml"><span class="tag">&lt;<span class="name">chr</span>&gt;</span></span>[obj]  Specify the character set</span><br><span class="line">  sfx[name]     Create SFX archive</span><br><span class="line">  si[name]      Read data from standard input (stdin)</span><br><span class="line">  sl<span class="xml"><span class="tag">&lt;<span class="name">size</span>&gt;</span></span>      Process files with size less than specified</span><br><span class="line">  sm<span class="xml"><span class="tag">&lt;<span class="name">size</span>&gt;</span></span>      Process files with size more than specified</span><br><span class="line">  t             Test files after archiving</span><br><span class="line">  ta<span class="xml"><span class="tag">&lt;<span class="name">date</span>&gt;</span></span>      Process files modified after <span class="xml"><span class="tag">&lt;<span class="name">date</span>&gt;</span></span> in YYYYMMDDHHMMSS format</span><br><span class="line">  tb<span class="xml"><span class="tag">&lt;<span class="name">date</span>&gt;</span></span>      Process files modified before <span class="xml"><span class="tag">&lt;<span class="name">date</span>&gt;</span></span> in YYYYMMDDHHMMSS format</span><br><span class="line">  tk            Keep original archive time</span><br><span class="line">  tl            Set archive time to latest file</span><br><span class="line">  tn<span class="xml"><span class="tag">&lt;<span class="name">time</span>&gt;</span></span>      Process files newer than <span class="xml"><span class="tag">&lt;<span class="name">time</span>&gt;</span></span></span><br><span class="line">  to<span class="xml"><span class="tag">&lt;<span class="name">time</span>&gt;</span></span>      Process files older than <span class="xml"><span class="tag">&lt;<span class="name">time</span>&gt;</span></span></span><br><span class="line">  ts<span class="xml"><span class="tag">&lt;<span class="name">m,c,a</span>&gt;</span></span>[N]  Save or restore file time (modification, creation, access)</span><br><span class="line">  u             Update files</span><br><span class="line">  v             Create volumes with size autodetection or list all volumes</span><br><span class="line">  v<span class="xml"><span class="tag">&lt;<span class="name">size</span>&gt;</span></span>[k,b]  Create volumes with size=<span class="xml"><span class="tag">&lt;<span class="name">size</span>&gt;</span></span><span class="emphasis">*1000 [*</span>1024, *1]</span><br><span class="line">  ver[n]        File version control</span><br><span class="line">  vn            Use the old style volume naming scheme</span><br><span class="line">  vp            Pause before each volume</span><br><span class="line">  w<span class="xml"><span class="tag">&lt;<span class="name">path</span>&gt;</span></span>       Assign work directory</span><br><span class="line">  x<span class="xml"><span class="tag">&lt;<span class="name">file</span>&gt;</span></span>       Exclude specified file</span><br><span class="line">  x@            Read file names to exclude from stdin</span><br><span class="line">  x@<span class="xml"><span class="tag">&lt;<span class="name">list</span>&gt;</span></span>      Exclude files in specified list file</span><br><span class="line">  y             Assume Yes on all queries</span><br><span class="line">  z[file]       Read archive comment from file</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;下载&quot;&gt;&lt;a href=&quot;#下载&quot; class=&quot;headerlink&quot; title=&quot;下载&quot;&gt;&lt;/a&gt;下载&lt;/h5&gt;&lt;p&gt;&lt;code&gt;# wget  http://www.rarlab.com/rar/rarlinux-3.8.0.tar.gz&lt;/code&gt;&lt;/
      
    
    </summary>
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/categories/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/tags/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>phpMyAdmin搭建</title>
    <link href="https://leeyj.coding.me/2019/04/26/phpMyAdmin%E6%90%AD%E5%BB%BA/"/>
    <id>https://leeyj.coding.me/2019/04/26/phpMyAdmin搭建/</id>
    <published>2019-04-26T07:30:09.000Z</published>
    <updated>2019-04-26T08:23:48.054Z</updated>
    
    <content type="html"><![CDATA[<h5 id="在已有的-lnmp-环境下搭建-phpMyAdmin。-由于服务器做了限制，隧道端口转发等都不能使用，导致-Navicat-管理工具不能使用，只能通过-phpMyAdmin-来进行管理了。"><a href="#在已有的-lnmp-环境下搭建-phpMyAdmin。-由于服务器做了限制，隧道端口转发等都不能使用，导致-Navicat-管理工具不能使用，只能通过-phpMyAdmin-来进行管理了。" class="headerlink" title="在已有的 lnmp 环境下搭建 phpMyAdmin。 由于服务器做了限制，隧道端口转发等都不能使用，导致 Navicat 管理工具不能使用，只能通过 phpMyAdmin 来进行管理了。"></a>在已有的 lnmp 环境下搭建 phpMyAdmin。 由于服务器做了限制，隧道端口转发等都不能使用，导致 Navicat 管理工具不能使用，只能通过 phpMyAdmin 来进行管理了。</h5><ul><li><p>下载phpMyAdmin\<br>官网地址：<a href="https://www.phpmyadmin.net/" target="_blank" rel="noopener">https://www.phpmyadmin.net/</a></p></li><li><p>上传到服务器进行安装</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># unzip phpMyAdmin-4.8.5-all-languages.zip</span><br><span class="line"># mv phpMyAdmin-4.8.5-all-languages /opt/phpMyAdmin</span><br><span class="line"># chown apache. /opt/phpMyAdmin</span><br></pre></td></tr></table></figure></li><li><p>编辑配置文件 config.default.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># vim /opt/phpMyAdmin/libraries/config.default.php</span><br><span class="line">$cfg[&apos;Servers&apos;][$i][&apos;host&apos;] = &apos;130.39.113.45&apos;;</span><br><span class="line">$cfg[&apos;Servers&apos;][$i][&apos;port&apos;] = &apos;3306&apos;;</span><br><span class="line">$cfg[&apos;Servers&apos;][$i][&apos;socket&apos;] = &apos;socket&apos;;</span><br><span class="line">$cfg[&apos;Servers&apos;][$i][&apos;user&apos;] = &apos;tj_court&apos;;</span><br><span class="line">$cfg[&apos;Servers&apos;][$i][&apos;password&apos;] = &apos;AigheiguSh4eesh0eey8&apos;;</span><br></pre></td></tr></table></figure></li><li><p>配置nginx站点</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># vim phpMyAdmin.conf</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  www.phpadmin.com;</span><br><span class="line">    autoindex off;</span><br><span class="line"></span><br><span class="line">    error_log  logs/phpadmin_error.log error;</span><br><span class="line">    access_log logs/phpadmin_access.log main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">    root /opt/phpMyAdmin;</span><br><span class="line">        index  index.php index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fastcgi_intercept_errors on;</span><br><span class="line">    error_page  404             /404.html;</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        root           html;</span><br><span class="line">        fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  /opt/phpMyAdmin$fastcgi_script_name;</span><br><span class="line">        include        fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ /\. &#123;</span><br><span class="line">        deny all;</span><br><span class="line">        error_page  403             /404.html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>配置完成后启动nginx访问配置的域名进行连接<br><img src="/2019/04/26/phpMyAdmin搭建/4.png" alt><br><img src="/2019/04/26/phpMyAdmin搭建/6.png" alt></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;在已有的-lnmp-环境下搭建-phpMyAdmin。-由于服务器做了限制，隧道端口转发等都不能使用，导致-Navicat-管理工具不能使用，只能通过-phpMyAdmin-来进行管理了。&quot;&gt;&lt;a href=&quot;#在已有的-lnmp-环境下搭建-phpMyAdmin
      
    
    </summary>
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/categories/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/tags/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>MySQL自动备份脚本</title>
    <link href="https://leeyj.coding.me/2019/04/24/MySQL%E8%87%AA%E5%8A%A8%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC/"/>
    <id>https://leeyj.coding.me/2019/04/24/MySQL自动备份脚本/</id>
    <published>2019-04-24T09:56:56.000Z</published>
    <updated>2019-04-25T05:08:45.051Z</updated>
    
    <content type="html"><![CDATA[<h5 id="通过-shell-脚本定时备份数据库，并定时清理"><a href="#通过-shell-脚本定时备份数据库，并定时清理" class="headerlink" title="通过 shell 脚本定时备份数据库，并定时清理"></a>通过 shell 脚本定时备份数据库，并定时清理</h5><p><code>ceshi yixia</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">#Desc:本地数据库备份脚本</span><br><span class="line">#Date:2017-12-24</span><br><span class="line">#by:Lee-YJ</span><br><span class="line">#运行脚本前先创建一个备份用户，并授予权限</span><br><span class="line">#mysql&gt; grant select,insert,lock tables,show view,trigger  on *.* to back@"127.0.0.1" identified by "oodaeh7phoe1iboh7Jua";</span><br><span class="line">#mysql&gt; flush privileges;</span><br><span class="line"></span><br><span class="line">mysqluser=back                    #用于数据库备份的用户名</span><br><span class="line">mysqlpassw=oodaeh7phoe1iboh7Jua   #用户密码</span><br><span class="line">mysqlhost=127.0.0.1               #连接数据库的host</span><br><span class="line">bakpath=/opt/data/Back/DBbak          #备份数据库存放的路径</span><br><span class="line"></span><br><span class="line">bakdate=`date '+%Y%m%d'`</span><br><span class="line">baktime=`date '+%H%M'`</span><br><span class="line"></span><br><span class="line">#----------------------------获取mysql中的数据库名---------------------------------</span><br><span class="line">/usr/bin/mysql -u$mysqluser -h $mysqlhost -p$mysqlpassw -e "show databases;"|grep -v Database|grep -v information_schema |grep -v performance_schema|grep -v mysql|grep -v test &gt; /tmp/DBname</span><br><span class="line"></span><br><span class="line">#----------------------------数据库备份--mysqldump备份------------------------------</span><br><span class="line"></span><br><span class="line">if [ ! -d "$bakpath" ];then</span><br><span class="line">    mkdir -p $bakpath</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">cd $bakpath</span><br><span class="line"></span><br><span class="line">if [ ! -d "$bakdate" ];then</span><br><span class="line">    mkdir $bakdate</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">cd $bakdate</span><br><span class="line"></span><br><span class="line">echo "------------------------$bakdate$baktime-------------------------------------" &gt;&gt; $bakpath/DBbak.log</span><br><span class="line">for DBname in `cat /tmp/DBname`;do</span><br><span class="line">    if [ ! -d "$DBname" ];then</span><br><span class="line">        mkdir $DBname</span><br><span class="line">    fi</span><br><span class="line">    /usr/bin/mysqldump --routines --triggers -u$mysqluser -h $mysqlhost -p$mysqlpassw $DBname  &gt; $DBname/$baktime\.sql</span><br><span class="line">    if [ $? = 0 ];then</span><br><span class="line">        echo "$DBname Back OK!" &gt;&gt; $bakpath/DBbak.log</span><br><span class="line">    else</span><br><span class="line">        echo "$DBname Back ERROR!" &gt;&gt; $bakpath/DBbak.log</span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line">echo "" &gt;&gt; $bakpath/DBbak.log </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#----------------------------删除5天之前的数据备份，并随机保留一份--------------------------------</span><br><span class="line">shopt -s extglob</span><br><span class="line">olddate=`date '+%Y%m%d' -d "-6 days"`</span><br><span class="line">cd $bakpath/$olddate</span><br><span class="line">for deldbname in `ls $bakpath/$olddate`;do</span><br><span class="line">    cd $deldbname</span><br><span class="line">    file=`ls| sort -R | head -n1`</span><br><span class="line">    rm -f !($file)</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">if [ ! -d "$bakpath/Oldest" ];then</span><br><span class="line">    mkdir -p $bakpath/Oldest</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">mv $bakpath/$olddate $bakpath/Oldest/</span><br><span class="line"></span><br><span class="line">rm -f /tmp/DBname</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h5 id=&quot;通过-shell-脚本定时备份数据库，并定时清理&quot;&gt;&lt;a href=&quot;#通过-shell-脚本定时备份数据库，并定时清理&quot; class=&quot;headerlink&quot; title=&quot;通过 shell 脚本定时备份数据库，并定时清理&quot;&gt;&lt;/a&gt;通过 shell 脚本定时备
      
    
    </summary>
    
      <category term="Shell" scheme="https://leeyj.coding.me/categories/Shell/"/>
    
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/tags/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>ftp虚拟用户</title>
    <link href="https://leeyj.coding.me/2019/04/23/ftp%E8%99%9A%E6%8B%9F%E7%94%A8%E6%88%B7/"/>
    <id>https://leeyj.coding.me/2019/04/23/ftp虚拟用户/</id>
    <published>2019-04-23T14:30:00.000Z</published>
    <updated>2019-04-23T14:37:22.762Z</updated>
    
    <content type="html"><![CDATA[<h3 id="需求："><a href="#需求：" class="headerlink" title="需求："></a>需求：</h3><p>进（账户）\<br>username: ftpComeSsbq\<br>password: ftp<em>come</em>#@UkieO9\<br>上传文件的目录：/opt/ftp/come</p><p>出（账户）\<br>username: ftpOutSsbq\<br>password: ftp<em>out</em>#@45oUkie\<br>上床文件的目录：/opt/ftp/out</p><h3 id="具体步骤"><a href="#具体步骤" class="headerlink" title="具体步骤"></a>具体步骤</h3><p>1 安装软件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum -y install vsftpd</span><br></pre></td></tr></table></figure></p><p>2 创建相应的ftp数据目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mkdir -p /opt/ftp/&#123;come,out&#125;</span><br></pre></td></tr></table></figure></p><p>3 创建一个用户提供给虚拟用户使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># useradd -s /sbin/nologin virtual</span><br></pre></td></tr></table></figure></p><p>4 将ftp数据目录设置成virtual用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># chown virtual. /opt/ftp/ -R</span><br><span class="line"># ll /opt/ftp/</span><br><span class="line">total 8</span><br><span class="line">drwxr-xr-x 2 virtual virtual 4096 Apr 17 12:07 come</span><br><span class="line">drwxr-xr-x 2 virtual virtual 4096 Apr 17 12:07 out</span><br></pre></td></tr></table></figure></p><p>5 创建虚拟帐号与密码的文本文件(一行账号，一行密码, 注意不要有多余的空格)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/vsftpd/logins.txt</span><br><span class="line">ftpComeSsbq</span><br><span class="line">ftp_come_#@UkieO9</span><br><span class="line">ftpOutSsbq</span><br><span class="line">ftp_out_#@45oUkie</span><br></pre></td></tr></table></figure></p><p>6 将创建好的密码文件txt格式转换db格式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># db_load -T -t hash -f /etc/vsftpd/logins.txt /etc/vsftpd/login.db</span><br></pre></td></tr></table></figure></p><p>7 定义db文件的权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chmod 600 /etc/vsftpd/login.db</span><br></pre></td></tr></table></figure></p><p>8 定义pam认证文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/pam.d/ftp</span><br><span class="line">auth  required  /lib64/security/pam_userdb.so  db=/etc/vsftpd/login</span><br><span class="line">account  required  /lib64/security/pam_userdb.so  db=/etc/vsftpd/login</span><br></pre></td></tr></table></figure></p><p>9 配置vsftpd主配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># cp /etc/vsftpd/vsftpd.conf&#123;,.bak&#125;</span><br><span class="line"># vim /etc/vsftpd/vsftpd.conf</span><br><span class="line">#禁止匿名登录FTP服务器</span><br><span class="line">anonymous_enable=NO</span><br><span class="line">#允许本地用户登录FTP服务器</span><br><span class="line">local_enable=YES</span><br><span class="line">#可以上传(全局控制) </span><br><span class="line">write_enable=NO</span><br><span class="line">#匿名用户可以上传</span><br><span class="line">anon_upload_enable=NO</span><br><span class="line">#匿名用户可以建目录</span><br><span class="line">anon_mkdir_write_enable=NO</span><br><span class="line">#匿名用户修改删除</span><br><span class="line">anon_other_write_enable=NO</span><br><span class="line">#全部用户被限制在主目录</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">#将所有用户看成虚拟用户guest</span><br><span class="line">guest_enable=YES</span><br><span class="line">#指定虚拟用户，也就是将guest用户映射到virtual用户</span><br><span class="line">guest_username=virtual</span><br><span class="line">#指定为独立服务</span><br><span class="line">listen=YES</span><br><span class="line">#指定监听的端口</span><br><span class="line">listen_port=21</span><br><span class="line">#开启被动模式</span><br><span class="line">pasv_enable=YES</span><br><span class="line">#FTP服务器公网IP</span><br><span class="line">pasv_address=120.79.93.66</span><br><span class="line">#设置被动模式下，建立数据传输可使用port范围的最小值</span><br><span class="line">pasv_min_port=10000</span><br><span class="line">#设置被动模式下，建立数据传输可使用port范围的最大值</span><br><span class="line">pasv_max_port=10088</span><br><span class="line">#是否允许匿名用户下载全局可读的文件</span><br><span class="line">anon_world_readable_only=NO</span><br><span class="line">#指定虚拟用户配置文件的路径</span><br><span class="line">user_config_dir=/etc/vsftpd/user_conf</span><br></pre></td></tr></table></figure></p><p>10 创建上面配置文件中指定的子配置文件目录 user_conf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mkdir /etc/vsftpd/user_conf</span><br></pre></td></tr></table></figure></p><p>11 定义 ftpComeSsbq 用户的配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/vsftpd/user_conf/ftpComeSsbq</span><br><span class="line">write_enable=YES</span><br><span class="line">anon_world_readable_only=no</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line">local_root=/opt/ftp/come</span><br></pre></td></tr></table></figure></p><p>12 定义 ftpOutSsbq 用户的配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/vsftpd/user_conf/ftpOutSsbq</span><br><span class="line">write_enable=YES</span><br><span class="line">anon_world_readable_only=no</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line">local_root=/opt/ftp/out</span><br></pre></td></tr></table></figure></p><p>13 启动vsftpd<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># service vsftpd start</span><br></pre></td></tr></table></figure></p><p>14 测试<br>…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;需求：&quot;&gt;&lt;a href=&quot;#需求：&quot; class=&quot;headerlink&quot; title=&quot;需求：&quot;&gt;&lt;/a&gt;需求：&lt;/h3&gt;&lt;p&gt;进（账户）\&lt;br&gt;username: ftpComeSsbq\&lt;br&gt;password: ftp&lt;em&gt;come&lt;/em&gt;#@Uk
      
    
    </summary>
    
      <category term="Linux" scheme="https://leeyj.coding.me/categories/Linux/"/>
    
    
      <category term="Linux运维日常" scheme="https://leeyj.coding.me/tags/Linux%E8%BF%90%E7%BB%B4%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
</feed>
